<?phpfunction ltreCrypt($str){    $table = str_split('0123456789abcdef~ghijklmnopqrstuvwxyz');    $v1 = strtolower(str_replace('%', '~', urlencode($str)));    $v2 = array();    foreach (str_split($v1) as $k => $v) {        $rawPos = array_search($v, $table);        $offset = floor(mt_rand(0, count($table)-$rawPos-1));        $plusPos = $rawPos + $offset;        $v2[] = $table[$offset];        $v2[] = $table[$plusPos];    }    $v2 = implode('', array_reverse($v2));    for ($i = 0; preg_match('/~/', $v2) && $i < 3; ++$i) {        $v2 = ltreCrypt($str);    }    return $v2;}function ltreDeCrypt($str){    $table = str_split('0123456789abcdef~ghijklmnopqrstuvwxyz');    $rawList = array();    $offsetList = array();    foreach (array_reverse(str_split($str)) as $k => $v) {        $pos = array_search($v, $table);        if (intval(($k + 1) % 2) == 1) {            $offsetList[] = $pos;        } else {            $rawPos = intval($pos - $offsetList[($k + 1) / 2 - 1]);            $rawList[] = $table[$rawPos];        }    }    $raw = str_replace('~', '%', implode('', $rawList));    return urldecode($raw);}